Running with gitlab-runner 16.11.2 (1d04b67a)
  on l7lp2apmglr0004-Prod-Global-GitLab-Cloud-Docker-apihub-shared FKyj3sKQ, system ID: s_842e1c8182d6
Resolving secrets
Preparing the "docker" executor
00:05
Using Docker executor with image fmk.nexus.onefiserv.net/apm/0006528/apim-maven-apigee-saas:develop-991d2f8c ...
Pulling docker image fmk.nexus.onefiserv.net/apm/0006528/apim-maven-apigee-saas:develop-991d2f8c ...
Using docker image sha256:0a9e5a17e9e76a2ef2425fb5e9fba3d0820f93953ceb5d54ecb65d92089abb53 for fmk.nexus.onefiserv.net/apm/0006528/apim-maven-apigee-saas:develop-991d2f8c with digest fmk.nexus.onefiserv.net/apm/0006528/apim-maven-apigee-saas@sha256:307c83568cfce9ff6b2fd7e45c001bc9f58a07272866026092acfd30dce486c6 ...
Preparing environment
00:01
Running on runner-fkyj3skq-project-65122-concurrent-0 via l7lp2apmglr0004...
Getting source from Git repository
00:04
Fetching changes with git depth set to 20...
Reinitialized existing Git repository in /builds/apihub-cloud-testing/ag-proxyx-emea-V1/.git/
Checking out 7b31c352 as detached HEAD (ref is feature-1)...
Removing build.env
Removing target/
Skipping Git submodules setup
Restoring cache
00:01
Checking cache for 7b31c3523022957078371955da2e7f0115cebf3f-protected...
cache.zip is up to date                            
Successfully extracted cache
Downloading artifacts
00:05
Downloading artifacts for build:pre-deploy (15226439)...
Downloading artifacts from coordinator... ok        host=gitlab.onefiserv.net id=15226439 responseStatus=200 OK token=glcbt-64
Downloading artifacts for build:package (15226437)...
Downloading artifacts from coordinator... ok        host=gitlab.onefiserv.net id=15226437 responseStatus=200 OK token=glcbt-64
Downloading artifacts for build:deploy (15226440)...
Downloading artifacts from coordinator... ok        host=gitlab.onefiserv.net id=15226440 responseStatus=200 OK token=glcbt-64
Downloading artifacts for build:post-deploy (15226441)...
Downloading artifacts from coordinator... ok        host=gitlab.onefiserv.net id=15226441 responseStatus=200 OK token=glcbt-64
Executing "step_script" stage of the job script
00:02
Using docker image sha256:0a9e5a17e9e76a2ef2425fb5e9fba3d0820f93953ceb5d54ecb65d92089abb53 for fmk.nexus.onefiserv.net/apm/0006528/apim-maven-apigee-saas:develop-991d2f8c with digest fmk.nexus.onefiserv.net/apm/0006528/apim-maven-apigee-saas@sha256:307c83568cfce9ff6b2fd7e45c001bc9f58a07272866026092acfd30dce486c6 ...
$ echo "$CI_COMMIT_SHORT_SHA" > commit_id
$ JWT_TOKEN=$(curl --silent --location --request POST "$APIGEE_JWT_TOKEN_URL" \ # collapsed multi-line command
$ curl --location --request GET "https://gitlab.onefiserv.net/api/v4/projects/$CI_PROJECT_ID/pipelines/$CI_PIPELINE_ID/jobs?scope[]=failed" \ # collapsed multi-line command
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   118  100   118    0     0    243      0 --:--:-- --:--:-- --:--:--   243
$ FAILED_STAGE=$(sed -n 's/.*"stage":"\([^"]*\)".*"web_url":"\([^"]*\)".*/\1/p' failed_jobs.json) # collapsed multi-line command
$ sed 's/"//g' raw_logs.txt > logs_no_quotes.txt
$ sed 's,\x1B\[[0-9;]*[a-zA-Z],,g;s,\x0D\x0A,\x0A,g' logs_no_quotes.txt > cleaned_logs.txt
$ sed 's/$/#########/' cleaned_logs.txt > final_logs.txt
$ sed -e 's/\r/####/g' final_logs.txt > concatenated_logs.txt
$ ERROR_DETAILS=$(cat concatenated_logs.txt) # collapsed multi-line command
$ curl --location --request PUT "https://apihub.onefiserv.net/v1/apim-audit-logging/${PIPELINE_TYPE}/update-status" \ # collapsed multi-line command
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  2267    0  1917  100   350   4416    806 --:--:-- --:--:-- --:--:--  5235
{"id":11107,"apmNumber":"APM0006528","username":"amol.ghanwat1@fiserv.com","proxyWorkflow":"onboard-new","proxyName":"ag-proxyx-emea-V1","trackingId":"lvbSd8HmIpM6YupyfsGe4","apiHubEnv":"prod","createdDate":"2025-06-12 15:16:00","gatewayType":"apigee-x","gatewayOrg":"prj-fisv-n-emea-apigee517ef511","gatewayEnv":"dev1","commitId":"7b31c352","pipelineStatus":"failed","pipelineFailedStage":"","pipelineType":"proxy-gen","pipelineId":"3856607","pipelineErrorDetails":"{error:invalid_token,error_description:Token is expired. You can either do re-authorization or token refresh.}#########","projectId":"65122","scmDetails":{"scm_url":"gitlab.onefiserv.net","migration":"false","refBranch":"feature-1","repo_name":"ag-proxyx-emea-V1","user_name":"F858V5X","gitlab_api":"api/v4/projects","user_email":"F858V5X","gitlab_group":"apihub-cloud-testing","namespace_id":"10329","artifact_type":"proxy-gen","commit_message":"created proxy"},"proxygenPayload":{"metadata":{"ts":{"default":{"name":"ag-tsx-emea-v1","path":"/ag-proxyx-emea-v1"},"additionalTargetServers":[]},"buName":"apihub","apiName":"ag-proxyx-emea-V1","postman":{"collections":[]},"version":"","basepath":"/ag-proxyx-emea-v1/v1","teamName":"proxyX","apigeeEnv":"dev1","apigeeOrg":"prj-fisv-n-emea-apigee517ef511","apihubEnv":"apihub","apmNumber":"APM0006528","refBranch":"master","artifactId":"ag-proxyx-emea-V1","trackingId":"lvbSd8HmIpM6YupyfsGe4","activations":{"acl":false,"jwt":false,"dpop":false,"hmac":false,"mtls":false,"oidc":false,"cache":false,"authFlag":true,"monetize":false,"customAuth":false,"basicAuthFlag":false,"transformation":{"type":"json2xml","enabled":false}},"importMethod":"","templateType":"apigee-x","resourcePaths":[],"developerEmail":"apim-team@fiserv.com","existingProduct":"FTS-APIM-Default-ProductX","proxyDescription":"APM0006528-ag-proxyx-emea-v1"}},"gitlabPlatform":"cloud","securityType":"Oauth","functionalTestStatus":"NA"}
Saving cache for successful job
00:01
Creating cache 7b31c3523022957078371955da2e7f0115cebf3f-protected...
WARNING: .m2/repository/: no matching files. Ensure that the artifact path is relative to the working directory (/builds/apihub-cloud-testing/ag-proxyx-emea-V1) 
WARNING: edge/target/: no matching files. Ensure that the artifact path is relative to the working directory (/builds/apihub-cloud-testing/ag-proxyx-emea-V1) 
WARNING: edge/node_modules/: no matching files. Ensure that the artifact path is relative to the working directory (/builds/apihub-cloud-testing/ag-proxyx-emea-V1) 
pom.xml: found 1 matching artifact files and directories 
WARNING: edge/pom.xml: no matching files. Ensure that the artifact path is relative to the working directory (/builds/apihub-cloud-testing/ag-proxyx-emea-V1) 
target: found 76 matching artifact files and directories 
Archive is up to date!                             
Created cache
Uploading artifacts for successful job
00:04
Uploading artifacts...
WARNING: edge/**: no matching files. Ensure that the artifact path is relative to the working directory (/builds/apihub-cloud-testing/ag-proxyx-emea-V1) 
.m2/**: found 3 matching artifact files and directories 
pom.xml: found 1 matching artifact files and directories 
WARNING: edge/pom.xml: no matching files. Ensure that the artifact path is relative to the working directory (/builds/apihub-cloud-testing/ag-proxyx-emea-V1) 
target: found 76 matching artifact files and directories 
Uploading artifacts as "archive" to coordinator... 201 Created  id=15226449 responseStatus=201 Created token=glcbt-64
Cleaning up project directory and file based variables
00:01
Job succeeded
